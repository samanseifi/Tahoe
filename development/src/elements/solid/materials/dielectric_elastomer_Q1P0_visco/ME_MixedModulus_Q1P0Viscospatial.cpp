#include "FSDEQ1P0Visco_inc.h"

#include <math.h>

static double z[415];

/* function to compute EM stiffness in current configuration */
/* reads in EM stiffness (Kem) from reference configuration, pushes it forward */
void me_mixedmodulus_q1p0viscospatial(const double* params, const double *Xsi, const double* Cmat, const double* Fmat, double J, double* Kempf) { 

/* common definitions */
#include "FSDEQ1P0Visco_common_defines.h"

	z[1] = -C12*C21;
	z[2] = C13*C21;
	z[3] = C11*C22;
	z[4] = -C13*C22;
	z[5] = -C11*C23;
	z[6] = C12*C23;
	z[7] = C12*C31;
	z[8] = -C13*C31;
	z[9] = -C22*C31;
	z[10] = C23*C31;
	z[11] = -C11*C32;
	z[12] = C13*C32;
	z[13] = C21*C32;
	z[14] = -C23*C32;
	z[15] = C11*C33;
	z[16] = -C12*C33;
	z[17] = -C21*C33;
	z[18] = C22*C33;
	z[19] = F11*F11;
	z[20] = pow(F11,3.);
	z[21] = F12*F12;
	z[22] = pow(F12,3.);
	z[23] = F13*F13;
	z[24] = pow(F13,3.);
	z[25] = F21*F21;
	z[26] = pow(F21,3.);
	z[27] = F22*F22;
	z[28] = pow(F22,3.);
	z[29] = F23*F23;
	z[30] = pow(F23,3.);
	z[31] = F31*F31;
	z[32] = pow(F31,3.);
	z[33] = F32*F32;
	z[34] = pow(F32,3.);
	z[35] = F33*F33;
	z[36] = pow(F33,3.);
	z[37] = C33*z[1];
	z[38] = C32*z[2];
	z[39] = C33*z[3];
	z[40] = C31*z[4];
	z[41] = C32*z[5];
	z[42] = C31*z[6];
	z[12] = z[12] + z[16];
	z[10] = z[10] + z[17];
	z[14] = z[14] + z[18];
	z[1] = z[1] + z[3];
	z[3] = z[37] + z[38] + z[39] + z[40] + z[41] + z[42];
	z[2] = z[2] + z[5];
	z[4] = z[4] + z[6];
	z[5] = z[11] + z[7];
	z[6] = z[15] + z[8];
	z[7] = z[13] + z[9];
	z[8] = z[12]*z[12];
	z[9] = z[10]*z[10];
	z[11] = z[14]*z[14];
	z[13] = z[1]*z[1];
	z[3] = 1./(z[3]*z[3]);
	z[15] = z[2]*z[2];
	z[16] = z[4]*z[4];
	z[17] = z[5]*z[5];
	z[18] = z[6]*z[6];
	z[37] = z[7]*z[7];
	z[12] = z[12]*z[3];
	z[38] = -2.*z[10]*z[14]*z[3];
	z[39] = -z[1]*z[10]*z[3];
	z[40] = z[1]*z[10]*z[3];
	z[41] = -z[1]*z[14]*z[3];
	z[42] = z[1]*z[14]*z[3];
	z[43] = -z[10]*z[2]*z[3];
	z[44] = z[10]*z[2]*z[3];
	z[45] = -z[14]*z[2]*z[3];
	z[46] = z[14]*z[2]*z[3];
	z[47] = -2.*z[1]*z[2]*z[3];
	z[48] = -z[10]*z[3]*z[4];
	z[49] = z[10]*z[3]*z[4];
	z[50] = z[14]*z[3]*z[4];
	z[51] = -2.*z[1]*z[3]*z[4];
	z[52] = -z[2]*z[3]*z[4];
	z[53] = z[2]*z[3]*z[4];
	z[54] = -z[10]*z[3]*z[5];
	z[55] = z[10]*z[3]*z[5];
	z[56] = -z[14]*z[3]*z[5];
	z[57] = z[14]*z[3]*z[5];
	z[58] = z[1]*z[3]*z[5];
	z[59] = -z[2]*z[3]*z[5];
	z[60] = z[2]*z[3]*z[5];
	z[61] = -z[3]*z[4]*z[5];
	z[62] = z[3]*z[4]*z[5];
	z[63] = z[10]*z[3]*z[6];
	z[64] = -z[14]*z[3]*z[6];
	z[65] = z[14]*z[3]*z[6];
	z[66] = -z[1]*z[3]*z[6];
	z[67] = z[1]*z[3]*z[6];
	z[68] = z[2]*z[3]*z[6];
	z[69] = -z[3]*z[4]*z[6];
	z[70] = z[3]*z[4]*z[6];
	z[71] = -2.*z[3]*z[5]*z[6];
	z[72] = -z[10]*z[3]*z[7];
	z[73] = z[10]*z[3]*z[7];
	z[74] = -2.*z[14]*z[3]*z[7];
	z[75] = z[1]*z[3]*z[7];
	z[76] = epsilon*ex*J*z[75];
	z[77] = epsilon*ez*J*z[75];
	z[78] = -z[2]*z[3]*z[7];
	z[79] = z[2]*z[3]*z[7];
	z[80] = -z[3]*z[4]*z[7];
	z[81] = z[3]*z[4]*z[7];
	z[82] = -z[3]*z[5]*z[7];
	z[83] = z[3]*z[5]*z[7];
	z[84] = -z[3]*z[6]*z[7];
	z[85] = z[3]*z[6]*z[7];
	z[86] = -z[3]*z[8];
	z[8] = z[3]*z[8];
	z[87] = -z[3]*z[9];
	z[9] = z[3]*z[9];
	z[11] = epsilon*ex*J*z[11]*z[3];
	z[13] = epsilon*ez*J*z[13]*z[3];
	z[88] = -z[15]*z[3];
	z[15] = z[15]*z[3];
	z[89] = -z[16]*z[3];
	z[16] = z[16]*z[3];
	z[90] = -z[17]*z[3];
	z[17] = z[17]*z[3];
	z[18] = epsilon*ey*J*z[18]*z[3];
	z[91] = -z[3]*z[37];
	z[3] = z[3]*z[37];
	z[37] = -z[10]*z[12];
	z[10] = z[10]*z[12];
	z[14] = z[12]*z[14];
	z[92] = epsilon*ex*J*z[14];
	z[93] = epsilon*ey*J*z[14];
	z[94] = -z[1]*z[12];
	z[1] = z[1]*z[12];
	z[95] = -z[12]*z[2];
	z[2] = z[12]*z[2];
	z[96] = -z[12]*z[4];
	z[4] = z[12]*z[4];
	z[97] = -z[12]*z[5];
	z[5] = z[12]*z[5];
	z[6] = -2.*z[12]*z[6];
	z[98] = -z[12]*z[7];
	z[7] = z[12]*z[7];
	z[12] = epsilon*ex*J*z[50];
	z[99] = epsilon*ez*J*z[50];
	z[100] = epsilon*ey*J*z[58];
	z[101] = epsilon*ez*J*z[58];
	z[102] = epsilon*ex*J*z[63];
	z[103] = epsilon*ey*J*z[63];
	z[104] = epsilon*ey*J*z[68];
	z[105] = epsilon*ez*J*z[68];
	z[106] = z[85] + z[95] + z[97];
	z[107] = z[2] + z[84] + z[97];
	z[108] = z[5] + z[84] + z[95];
	z[11] = z[11] + z[93] + z[99];
	z[13] = z[100] + z[13] + z[76];
	z[18] = z[102] + z[105] + z[18];
	z[14] = z[14] + z[38];
	z[38] = z[39] + z[79] + z[82];
	z[76] = z[39] + z[78] + z[83];
	z[93] = z[40] + z[78] + z[82];
	z[99] = z[41] + z[81] + z[89];
	z[16] = z[16] + z[41] + z[80];
	z[81] = z[41] + z[81] + z[91];
	z[3] = z[3] + z[41] + z[80];
	z[41] = z[42] + z[80] + z[89];
	z[42] = z[42] + z[80] + z[91];
	z[80] = z[4] + z[45] + z[48];
	z[89] = z[46] + z[48] + z[96];
	z[91] = z[45] + z[49] + z[96];
	z[50] = z[50] + z[74];
	z[51] = z[51] + z[75];
	z[74] = z[52] + z[79] + z[94];
	z[75] = z[1] + z[52] + z[78];
	z[78] = z[53] + z[78] + z[94];
	z[79] = z[43] + z[54] + z[85];
	z[85] = z[44] + z[54] + z[84];
	z[84] = z[43] + z[55] + z[84];
	z[4] = z[4] + z[56] + z[98];
	z[100] = z[56] + z[7] + z[96];
	z[96] = z[57] + z[96] + z[98];
	z[47] = z[47] + z[58];
	z[58] = z[61] + z[83] + z[94];
	z[1] = z[1] + z[61] + z[82];
	z[40] = z[40] + z[52] + z[61];
	z[53] = z[39] + z[53] + z[61];
	z[61] = z[62] + z[82] + z[94];
	z[39] = z[39] + z[52] + z[62];
	z[6] = z[6] + z[63];
	z[8] = z[37] + z[64] + z[8];
	z[9] = z[37] + z[64] + z[9];
	z[52] = z[10] + z[64] + z[86];
	z[10] = z[10] + z[64] + z[87];
	z[62] = z[37] + z[65] + z[86];
	z[37] = z[37] + z[65] + z[87];
	z[15] = z[15] + z[59] + z[66];
	z[17] = z[17] + z[59] + z[66];
	z[63] = z[60] + z[66] + z[88];
	z[60] = z[60] + z[66] + z[90];
	z[64] = z[59] + z[67] + z[88];
	z[59] = z[59] + z[67] + z[90];
	z[2] = z[2] + z[43] + z[69];
	z[44] = z[44] + z[69] + z[95];
	z[5] = z[5] + z[54] + z[69];
	z[55] = z[55] + z[69] + z[97];
	z[43] = z[43] + z[70] + z[95];
	z[54] = z[54] + z[70] + z[97];
	z[65] = z[68] + z[71];
	z[7] = z[45] + z[7] + z[72];
	z[46] = z[46] + z[72] + z[98];
	z[49] = z[49] + z[56] + z[72];
	z[57] = z[48] + z[57] + z[72];
	z[45] = z[45] + z[73] + z[98];
	z[48] = z[48] + z[56] + z[73];
	z[56] = -epsilon*ey*J;
	z[66] = F11*F21*F31*z[11];
	z[67] = F13*F23*F33*z[13];
	z[68] = F12*F22*F32*z[18];
	z[14] = -epsilon*ex*J*z[14];
	z[38] = -epsilon*ex*J*z[38];
	z[69] = -epsilon*ex*J*z[76];
	z[70] = -epsilon*ex*J*z[93];
	z[71] = -epsilon*ez*J*z[99];
	z[16] = -epsilon*ez*J*z[16];
	z[72] = -epsilon*ex*J*z[81];
	z[3] = -epsilon*ex*J*z[3];
	z[41] = -epsilon*ez*J*z[41];
	z[42] = -epsilon*ex*J*z[42];
	z[73] = -epsilon*ez*J*z[80];
	z[76] = -epsilon*ez*J*z[89];
	z[80] = -epsilon*ez*J*z[91];
	z[50] = -epsilon*ex*J*z[50];
	z[51] = -epsilon*ez*J*z[51];
	z[74] = -epsilon*ez*J*z[74];
	z[75] = -epsilon*ez*J*z[75];
	z[78] = -epsilon*ez*J*z[78];
	z[79] = -epsilon*ex*J*z[79];
	z[81] = -epsilon*ex*J*z[85];
	z[82] = -epsilon*ex*J*z[84];
	z[47] = -epsilon*ez*J*z[47];
	z[40] = -epsilon*ez*J*z[40];
	z[53] = -epsilon*ez*J*z[53];
	z[39] = -epsilon*ez*J*z[39];
	z[83] = F21*z[11]*z[19];
	z[84] = F31*z[11]*z[19];
	z[9] = -epsilon*ex*J*z[9];
	z[10] = -epsilon*ex*J*z[10];
	z[37] = -epsilon*ex*J*z[37];
	z[15] = -epsilon*ez*J*z[15];
	z[63] = -epsilon*ez*J*z[63];
	z[64] = -epsilon*ez*J*z[64];
	z[20] = z[11]*z[20];
	z[2] = -epsilon*ez*J*z[2];
	z[44] = -epsilon*ez*J*z[44];
	z[43] = -epsilon*ez*J*z[43];
	z[7] = -epsilon*ex*J*z[7];
	z[46] = -epsilon*ex*J*z[46];
	z[85] = F22*z[18]*z[21];
	z[86] = F32*z[18]*z[21];
	z[49] = -epsilon*ex*J*z[49];
	z[57] = -epsilon*ex*J*z[57];
	z[45] = -epsilon*ex*J*z[45];
	z[48] = -epsilon*ex*J*z[48];
	z[87] = z[106]*z[56];
	z[88] = z[107]*z[56];
	z[89] = z[108]*z[56];
	z[4] = z[4]*z[56];
	z[90] = z[100]*z[56];
	z[91] = z[56]*z[96];
	z[58] = z[56]*z[58];
	z[1] = z[1]*z[56];
	z[61] = z[56]*z[61];
	z[6] = z[56]*z[6];
	z[8] = z[56]*z[8];
	z[52] = z[52]*z[56];
	z[62] = z[56]*z[62];
	z[17] = z[17]*z[56];
	z[60] = z[56]*z[60];
	z[59] = z[56]*z[59];
	z[5] = z[5]*z[56];
	z[55] = z[55]*z[56];
	z[54] = z[54]*z[56];
	z[56] = z[56]*z[65];
	z[22] = z[18]*z[22];
	z[65] = F23*z[13]*z[23];
	z[93] = F33*z[13]*z[23];
	z[24] = z[13]*z[24];
	z[94] = F11*z[11]*z[25];
	z[95] = F31*z[11]*z[25];
	z[26] = z[11]*z[26];
	z[96] = F12*z[18]*z[27];
	z[97] = F32*z[18]*z[27];
	z[28] = z[18]*z[28];
	z[98] = F13*z[13]*z[29];
	z[99] = F33*z[13]*z[29];
	z[30] = z[13]*z[30];
	z[100] = F11*z[11]*z[31];
	z[102] = F21*z[11]*z[31];
	z[11] = z[11]*z[32];
	z[32] = F12*z[18]*z[33];
	z[105] = F22*z[18]*z[33];
	z[18] = z[18]*z[34];
	z[34] = F13*z[13]*z[35];
	z[106] = F23*z[13]*z[35];
	z[13] = z[13]*z[36];
	z[36] = z[104] + z[63] + z[82];
	z[63] = z[104] + z[64] + z[79];
	z[2] = z[10] + z[103] + z[2];
	z[10] = z[103] + z[37] + z[43];
	z[37] = z[45] + z[74] + z[87];
	z[43] = z[46] + z[78] + z[88];
	z[7] = z[7] + z[75] + z[89];
	z[4] = z[16] + z[4] + z[50];
	z[16] = z[12] + z[71] + z[90];
	z[12] = z[12] + z[41] + z[91];
	z[3] = z[3] + z[51] + z[58];
	z[1] = z[1] + z[42] + z[77];
	z[41] = z[61] + z[72] + z[77];
	z[6] = z[44] + z[6] + z[9];
	z[8] = z[14] + z[73] + z[8];
	z[9] = z[52] + z[80] + z[92];
	z[14] = z[62] + z[76] + z[92];
	z[17] = z[17] + z[47] + z[69];
	z[38] = z[101] + z[38] + z[60];
	z[42] = z[101] + z[59] + z[70];
	z[5] = z[39] + z[5] + z[57];
	z[39] = z[40] + z[48] + z[55];
	z[40] = z[49] + z[53] + z[54];
	z[15] = z[15] + z[56] + z[81];
	z[44] = F12*z[36];
	z[45] = F22*F23*F32*z[36];
	z[46] = F22*F32*F33*z[36];
	z[47] = F13*z[21]*z[36];
	z[48] = F23*z[21]*z[36];
	z[49] = F33*z[21]*z[36];
	z[50] = F23*z[27]*z[36];
	z[51] = F33*z[27]*z[36];
	z[52] = F12*F13*F22*z[63];
	z[53] = F12*F22*F23*z[63];
	z[54] = F12*F13*F32*z[63];
	z[55] = F13*F22*F32*z[63];
	z[56] = F12*F23*F32*z[63];
	z[57] = F22*F23*F32*z[63];
	z[58] = F12*F22*F33*z[63];
	z[59] = F12*F32*F33*z[63];
	z[60] = F22*F32*F33*z[63];
	z[61] = F13*z[21]*z[63];
	z[62] = F23*z[21]*z[63];
	z[64] = F33*z[21]*z[63];
	z[69] = F13*z[27]*z[63];
	z[70] = F23*z[27]*z[63];
	z[71] = F33*z[27]*z[63];
	z[72] = F11*F12*F22*z[2];
	z[73] = F12*F21*F22*z[2];
	z[74] = F12*F22*F31*z[2];
	z[75] = F11*F12*F32*z[2];
	z[76] = F12*F21*F32*z[2];
	z[77] = F21*F22*F32*z[2];
	z[78] = F12*F31*F32*z[2];
	z[79] = F22*F31*F32*z[2];
	z[80] = F11*z[2]*z[21];
	z[81] = F21*z[2]*z[21];
	z[82] = F31*z[2]*z[21];
	z[87] = F21*z[2]*z[27];
	z[88] = F31*z[2]*z[27];
	z[89] = F11*F12*F22*z[10];
	z[90] = F12*F21*F22*z[10];
	z[91] = F12*F22*F31*z[10];
	z[92] = F11*F12*F32*z[10];
	z[101] = F12*F21*F32*z[10];
	z[103] = F11*F22*F32*z[10];
	z[104] = F21*F22*F32*z[10];
	z[107] = F12*F31*F32*z[10];
	z[108] = F22*F31*F32*z[10];
	z[109] = F11*z[10]*z[21];
	z[110] = F21*z[10]*z[21];
	z[111] = F31*z[10]*z[21];
	z[112] = F11*z[10]*z[27];
	z[113] = F21*z[10]*z[27];
	z[114] = F31*z[10]*z[27];
	z[115] = F11*F12*F13*z[37];
	z[116] = F11*F13*F22*z[37];
	z[117] = F11*F12*F23*z[37];
	z[118] = F12*F21*F23*z[37];
	z[119] = F11*F22*F23*z[37];
	z[120] = F21*F22*F23*z[37];
	z[121] = F11*F13*F32*z[37];
	z[122] = F11*F23*F32*z[37];
	z[123] = F21*F23*F32*z[37];
	z[124] = F11*F12*F33*z[37];
	z[125] = F12*F21*F33*z[37];
	z[126] = F11*F22*F33*z[37];
	z[127] = F21*F22*F33*z[37];
	z[128] = F12*F31*F33*z[37];
	z[129] = F22*F31*F33*z[37];
	z[130] = F11*F32*F33*z[37];
	z[131] = F21*F32*F33*z[37];
	z[37] = F31*F32*F33*z[37];
	z[132] = F11*F12*F13*z[43];
	z[133] = F12*F13*F21*z[43];
	z[134] = F11*F13*F22*z[43];
	z[135] = F13*F21*F22*z[43];
	z[136] = F11*F22*F23*z[43];
	z[137] = F21*F22*F23*z[43];
	z[138] = F12*F13*F31*z[43];
	z[139] = F13*F22*F31*z[43];
	z[140] = F22*F23*F31*z[43];
	z[141] = F11*F13*F32*z[43];
	z[142] = F13*F21*F32*z[43];
	z[143] = F11*F23*F32*z[43];
	z[144] = F21*F23*F32*z[43];
	z[145] = F13*F31*F32*z[43];
	z[146] = F23*F31*F32*z[43];
	z[147] = F11*F32*F33*z[43];
	z[148] = F21*F32*F33*z[43];
	z[43] = F31*F32*F33*z[43];
	z[149] = F11*F12*F13*z[7];
	z[150] = F12*F13*F21*z[7];
	z[151] = F13*F21*F22*z[7];
	z[152] = F11*F12*F23*z[7];
	z[153] = F12*F21*F23*z[7];
	z[154] = F21*F22*F23*z[7];
	z[155] = F12*F13*F31*z[7];
	z[156] = F13*F22*F31*z[7];
	z[157] = F12*F23*F31*z[7];
	z[158] = F22*F23*F31*z[7];
	z[159] = F13*F31*F32*z[7];
	z[160] = F23*F31*F32*z[7];
	z[161] = F11*F12*F33*z[7];
	z[162] = F12*F21*F33*z[7];
	z[163] = F21*F22*F33*z[7];
	z[164] = F12*F31*F33*z[7];
	z[165] = F22*F31*F33*z[7];
	z[7] = F31*F32*F33*z[7];
	z[166] = F11*F13*F21*z[4];
	z[167] = F11*F21*F23*z[4];
	z[168] = F11*F13*F31*z[4];
	z[169] = F13*F21*F31*z[4];
	z[170] = F11*F23*F31*z[4];
	z[171] = F21*F23*F31*z[4];
	z[172] = F11*F31*F33*z[4];
	z[173] = F21*F31*F33*z[4];
	z[174] = F13*z[19]*z[4];
	z[175] = F13*z[25]*z[4];
	z[176] = F23*z[25]*z[4];
	z[177] = F13*z[31]*z[4];
	z[178] = F23*z[31]*z[4];
	z[4] = F33*z[31]*z[4];
	z[179] = F11*F13*F21*z[16];
	z[180] = F11*F21*F23*z[16];
	z[181] = F11*F13*F31*z[16];
	z[182] = F11*F23*F31*z[16];
	z[183] = F21*F23*F31*z[16];
	z[184] = F11*F21*F33*z[16];
	z[185] = F11*F31*F33*z[16];
	z[186] = F21*F31*F33*z[16];
	z[187] = F13*z[16]*z[19];
	z[188] = F23*z[16]*z[19];
	z[189] = F33*z[16]*z[19];
	z[190] = F23*z[16]*z[25];
	z[191] = F33*z[16]*z[25];
	z[16] = F33*z[16]*z[31];
	z[192] = F11*F13*F21*z[12];
	z[193] = F11*F21*F23*z[12];
	z[194] = F11*F13*F31*z[12];
	z[195] = F13*F21*F31*z[12];
	z[196] = F11*F23*F31*z[12];
	z[197] = F21*F23*F31*z[12];
	z[198] = F11*F21*F33*z[12];
	z[199] = F11*F31*F33*z[12];
	z[200] = F21*F31*F33*z[12];
	z[201] = F13*z[12]*z[19];
	z[202] = F23*z[12]*z[19];
	z[203] = F33*z[12]*z[19];
	z[204] = F13*z[12]*z[25];
	z[205] = F23*z[12]*z[25];
	z[206] = F33*z[12]*z[25];
	z[207] = F13*z[12]*z[31];
	z[208] = F23*z[12]*z[31];
	z[12] = F33*z[12]*z[31];
	z[209] = F11*F13*F23*z[3];
	z[210] = F13*F21*F23*z[3];
	z[211] = F11*F13*F33*z[3];
	z[212] = F13*F21*F33*z[3];
	z[213] = F11*F23*F33*z[3];
	z[214] = F21*F23*F33*z[3];
	z[215] = F13*F31*F33*z[3];
	z[216] = F23*F31*F33*z[3];
	z[217] = F11*z[23]*z[3];
	z[218] = F11*z[29]*z[3];
	z[219] = F21*z[29]*z[3];
	z[220] = F11*F13*F23*z[1];
	z[221] = F13*F21*F23*z[1];
	z[222] = F13*F23*F31*z[1];
	z[223] = F11*F13*F33*z[1];
	z[224] = F13*F21*F33*z[1];
	z[225] = F11*F23*F33*z[1];
	z[226] = F21*F23*F33*z[1];
	z[227] = F13*F31*F33*z[1];
	z[228] = F23*F31*F33*z[1];
	z[229] = F11*z[1]*z[23];
	z[230] = F21*z[1]*z[23];
	z[231] = F31*z[1]*z[23];
	z[232] = F11*z[1]*z[29];
	z[233] = F21*z[1]*z[29];
	z[234] = F31*z[1]*z[29];
	z[235] = F11*F13*F23*z[41];
	z[236] = F13*F21*F23*z[41];
	z[237] = F13*F23*F31*z[41];
	z[238] = F11*F13*F33*z[41];
	z[239] = F13*F21*F33*z[41];
	z[240] = F21*F23*F33*z[41];
	z[241] = F13*F31*F33*z[41];
	z[242] = F23*F31*F33*z[41];
	z[243] = F11*z[23]*z[41];
	z[244] = F21*z[23]*z[41];
	z[245] = F31*z[23]*z[41];
	z[246] = F21*z[29]*z[41];
	z[247] = F31*z[29]*z[41];
	z[248] = F11*F12*F22*z[6];
	z[249] = F12*F21*F22*z[6];
	z[250] = F11*F12*F32*z[6];
	z[251] = F12*F21*F32*z[6];
	z[252] = F11*F22*F32*z[6];
	z[253] = F21*F22*F32*z[6];
	z[254] = F12*F31*F32*z[6];
	z[255] = F22*F31*F32*z[6];
	z[256] = F11*z[21]*z[6];
	z[257] = F11*z[27]*z[6];
	z[258] = F21*z[27]*z[6];
	z[259] = F11*F12*F21*z[8];
	z[260] = F11*F21*F22*z[8];
	z[261] = F11*F12*F31*z[8];
	z[262] = F12*F21*F31*z[8];
	z[263] = F11*F22*F31*z[8];
	z[264] = F21*F22*F31*z[8];
	z[265] = F11*F31*F32*z[8];
	z[266] = F21*F31*F32*z[8];
	z[267] = F12*z[19]*z[8];
	z[268] = F12*z[25]*z[8];
	z[269] = F22*z[25]*z[8];
	z[270] = F12*z[31]*z[8];
	z[271] = F22*z[31]*z[8];
	z[8] = F32*z[31]*z[8];
	z[272] = F11*F12*F21*z[9];
	z[273] = F11*F21*F22*z[9];
	z[274] = F11*F12*F31*z[9];
	z[275] = F11*F22*F31*z[9];
	z[276] = F21*F22*F31*z[9];
	z[277] = F11*F21*F32*z[9];
	z[278] = F11*F31*F32*z[9];
	z[279] = F21*F31*F32*z[9];
	z[280] = F12*z[19]*z[9];
	z[281] = F22*z[19]*z[9];
	z[282] = F32*z[19]*z[9];
	z[283] = F22*z[25]*z[9];
	z[284] = F32*z[25]*z[9];
	z[9] = F32*z[31]*z[9];
	z[285] = F11*F12*F21*z[14];
	z[286] = F11*F21*F22*z[14];
	z[287] = F11*F12*F31*z[14];
	z[288] = F12*F21*F31*z[14];
	z[289] = F11*F22*F31*z[14];
	z[290] = F21*F22*F31*z[14];
	z[291] = F11*F21*F32*z[14];
	z[292] = F11*F31*F32*z[14];
	z[293] = F21*F31*F32*z[14];
	z[294] = F12*z[14]*z[19];
	z[295] = F22*z[14]*z[19];
	z[19] = F32*z[14]*z[19];
	z[296] = F12*z[14]*z[25];
	z[297] = F22*z[14]*z[25];
	z[25] = F32*z[14]*z[25];
	z[298] = F12*z[14]*z[31];
	z[299] = F22*z[14]*z[31];
	z[14] = F32*z[14]*z[31];
	z[31] = F12*F13*F23*z[17];
	z[300] = F13*F22*F23*z[17];
	z[301] = F12*F13*F33*z[17];
	z[302] = F13*F22*F33*z[17];
	z[303] = F12*F23*F33*z[17];
	z[304] = F22*F23*F33*z[17];
	z[305] = F13*F32*F33*z[17];
	z[306] = F23*F32*F33*z[17];
	z[307] = F12*z[17]*z[23];
	z[308] = F12*z[17]*z[29];
	z[309] = F22*z[17]*z[29];
	z[310] = F12*F13*F23*z[38];
	z[311] = F13*F22*F23*z[38];
	z[312] = F13*F23*F32*z[38];
	z[313] = F12*F13*F33*z[38];
	z[314] = F13*F22*F33*z[38];
	z[315] = F22*F23*F33*z[38];
	z[316] = F13*F32*F33*z[38];
	z[317] = F23*F32*F33*z[38];
	z[318] = F12*z[23]*z[38];
	z[319] = F22*z[23]*z[38];
	z[320] = F32*z[23]*z[38];
	z[321] = F22*z[29]*z[38];
	z[322] = F32*z[29]*z[38];
	z[323] = F12*F13*F23*z[42];
	z[324] = F13*F22*F23*z[42];
	z[325] = F13*F23*F32*z[42];
	z[326] = F12*F13*F33*z[42];
	z[327] = F13*F22*F33*z[42];
	z[328] = F12*F23*F33*z[42];
	z[329] = F22*F23*F33*z[42];
	z[330] = F13*F32*F33*z[42];
	z[331] = F23*F32*F33*z[42];
	z[332] = F12*z[23]*z[42];
	z[333] = F22*z[23]*z[42];
	z[23] = F32*z[23]*z[42];
	z[334] = F12*z[29]*z[42];
	z[335] = F22*z[29]*z[42];
	z[29] = F32*z[29]*z[42];
	z[336] = F11*F12*F13*z[5];
	z[337] = F12*F13*F21*z[5];
	z[338] = F11*F12*F23*z[5];
	z[339] = F12*F21*F23*z[5];
	z[340] = F11*F22*F23*z[5];
	z[341] = F21*F22*F23*z[5];
	z[342] = F12*F13*F31*z[5];
	z[343] = F12*F23*F31*z[5];
	z[344] = F22*F23*F31*z[5];
	z[345] = F11*F12*F33*z[5];
	z[346] = F12*F21*F33*z[5];
	z[347] = F11*F22*F33*z[5];
	z[348] = F21*F22*F33*z[5];
	z[349] = F12*F31*F33*z[5];
	z[350] = F22*F31*F33*z[5];
	z[351] = F11*F32*F33*z[5];
	z[352] = F21*F32*F33*z[5];
	z[5] = F31*F32*F33*z[5];
	z[353] = F11*F12*F13*z[39];
	z[354] = F11*F13*F22*z[39];
	z[355] = F13*F21*F22*z[39];
	z[356] = F11*F12*F23*z[39];
	z[357] = F11*F22*F23*z[39];
	z[358] = F21*F22*F23*z[39];
	z[359] = F11*F13*F32*z[39];
	z[360] = F13*F21*F32*z[39];
	z[361] = F11*F23*F32*z[39];
	z[362] = F21*F23*F32*z[39];
	z[363] = F13*F31*F32*z[39];
	z[364] = F23*F31*F32*z[39];
	z[365] = F11*F12*F33*z[39];
	z[366] = F11*F22*F33*z[39];
	z[367] = F21*F22*F33*z[39];
	z[368] = F11*F32*F33*z[39];
	z[369] = F21*F32*F33*z[39];
	z[39] = F31*F32*F33*z[39];
	z[370] = F11*F12*F13*z[40];
	z[371] = F12*F13*F21*z[40];
	z[372] = F11*F13*F22*z[40];
	z[373] = F13*F21*F22*z[40];
	z[374] = F12*F21*F23*z[40];
	z[375] = F21*F22*F23*z[40];
	z[376] = F12*F13*F31*z[40];
	z[377] = F13*F22*F31*z[40];
	z[378] = F12*F23*F31*z[40];
	z[379] = F22*F23*F31*z[40];
	z[380] = F11*F13*F32*z[40];
	z[381] = F13*F21*F32*z[40];
	z[382] = F21*F23*F32*z[40];
	z[383] = F13*F31*F32*z[40];
	z[384] = F23*F31*F32*z[40];
	z[385] = F12*F31*F33*z[40];
	z[386] = F22*F31*F33*z[40];
	z[40] = F31*F32*F33*z[40];
	z[387] = F12*F13*F22*z[15];
	z[388] = F12*F22*F23*z[15];
	z[389] = F12*F13*F32*z[15];
	z[390] = F13*F22*F32*z[15];
	z[391] = F12*F23*F32*z[15];
	z[392] = F22*F23*F32*z[15];
	z[393] = F12*F32*F33*z[15];
	z[394] = F22*F32*F33*z[15];
	z[21] = F13*z[15]*z[21];
	z[395] = F13*z[15]*z[27];
	z[27] = F23*z[15]*z[27];
	z[396] = F13*z[44];
	z[397] = F22*z[44];
	z[398] = F23*F32*z[44];
	z[44] = F32*F33*z[44];
	z[36] = F33*z[33]*z[36];
	z[399] = F13*z[33]*z[63];
	z[400] = F23*z[33]*z[63];
	z[63] = F33*z[33]*z[63];
	z[2] = F31*z[2]*z[33];
	z[401] = F11*z[10]*z[33];
	z[402] = F21*z[10]*z[33];
	z[10] = F31*z[10]*z[33];
	z[403] = F11*z[33]*z[6];
	z[404] = F21*z[33]*z[6];
	z[6] = F31*z[33]*z[6];
	z[405] = F13*z[15]*z[33];
	z[406] = F23*z[15]*z[33];
	z[15] = F33*z[15]*z[33];
	z[33] = F11*z[3]*z[35];
	z[407] = F21*z[3]*z[35];
	z[3] = F31*z[3]*z[35];
	z[408] = F11*z[1]*z[35];
	z[409] = F21*z[1]*z[35];
	z[1] = F31*z[1]*z[35];
	z[41] = F31*z[35]*z[41];
	z[410] = F12*z[17]*z[35];
	z[411] = F22*z[17]*z[35];
	z[17] = F32*z[17]*z[35];
	z[38] = F32*z[35]*z[38];
	z[412] = F12*z[35]*z[42];
	z[413] = F22*z[35]*z[42];
	z[35] = F32*z[35]*z[42];
	z[42] = F22*z[396];
	z[396] = F32*z[396];
	z[414] = F23*z[397];
	z[397] = F33*z[397];
	z[48] = z[117] + z[134] + z[150] + z[48] + z[52] + z[65] + z[81] + z[83] + z[85] + z[89];
	z[49] = z[124] + z[141] + z[155] + z[49] + z[54] + z[82] + z[84] + z[86] + z[92] + z[93];
	z[51] = z[104] + z[127] + z[144] + z[158] + z[51] + z[57] + z[88] + z[95] + z[97] + z[99];
	z[45] = z[114] + z[123] + z[140] + z[163] + z[45] + z[71] + z[77] + z[95] + z[97] + z[99];
	z[20] = z[109] + z[115] + z[132] + z[149] + z[20] + z[22] + z[24] + z[47] + z[61] + z[80];
	z[22] = z[113] + z[120] + z[137] + z[154] + z[26] + z[28] + z[30] + z[50] + z[70] + z[87];
	z[24] = z[122] + z[139] + z[162] + z[169] + z[58] + z[66] + z[67] + z[68] + z[76] + z[91];
	z[26] = z[100] + z[107] + z[130] + z[145] + z[164] + z[177] + z[32] + z[34] + z[59] + z[78];
	z[28] = z[102] + z[105] + z[106] + z[108] + z[131] + z[146] + z[165] + z[46] + z[60] + z[79];
	z[30] = z[100] + z[128] + z[147] + z[159] + z[172] + z[185] + z[207] + z[32] + z[34] + z[78];
	z[32] = z[102] + z[105] + z[106] + z[129] + z[148] + z[160] + z[173] + z[186] + z[46] + z[79];
	z[4] = z[11] + z[12] + z[13] + z[16] + z[18] + z[37] + z[4] + z[43] + z[7] + z[8];
	z[7] = z[110] + z[116] + z[133] + z[152] + z[166] + z[62] + z[65] + z[72] + z[83] + z[85];
	z[8] = z[111] + z[121] + z[138] + z[161] + z[168] + z[64] + z[75] + z[84] + z[86] + z[93];
	z[11] = z[112] + z[118] + z[136] + z[151] + z[167] + z[69] + z[73] + z[94] + z[96] + z[98];
	z[12] = z[119] + z[135] + z[153] + z[175] + z[53] + z[73] + z[90] + z[94] + z[96] + z[98];
	z[13] = z[101] + z[126] + z[142] + z[157] + z[169] + z[56] + z[66] + z[67] + z[68] + z[74];
	z[16] = z[103] + z[125] + z[143] + z[156] + z[170] + z[55] + z[66] + z[67] + z[68] + z[74];
	z[18] = z[166] + z[188] + z[192] + z[209] + z[220] + z[244] + z[248] + z[259] + z[281] + z[285];
	z[34] = z[168] + z[189] + z[194] + z[211] + z[223] + z[245] + z[250] + z[261] + z[282] + z[287];
	z[37] = z[171] + z[191] + z[197] + z[214] + z[226] + z[247] + z[253] + z[264] + z[284] + z[290];
	z[25] = z[171] + z[183] + z[206] + z[214] + z[234] + z[240] + z[25] + z[253] + z[264] + z[276];
	z[43] = z[174] + z[187] + z[201] + z[217] + z[229] + z[243] + z[256] + z[267] + z[280] + z[294];
	z[46] = z[176] + z[190] + z[205] + z[219] + z[233] + z[246] + z[258] + z[269] + z[283] + z[297];
	z[47] = z[182] + z[198] + z[213] + z[222] + z[239] + z[252] + z[262] + z[275] + z[291] + z[303];
	z[50] = z[185] + z[199] + z[227] + z[241] + z[270] + z[278] + z[292] + z[316] + z[330] + z[349];
	z[52] = z[178] + z[186] + z[200] + z[228] + z[242] + z[271] + z[279] + z[293] + z[317] + z[331];
	z[53] = z[215] + z[241] + z[254] + z[265] + z[278] + z[298] + z[305] + z[316] + z[351] + z[363];
	z[54] = z[208] + z[216] + z[242] + z[255] + z[266] + z[279] + z[299] + z[306] + z[317] + z[352];
	z[2] = z[10] + z[14] + z[2] + z[36] + z[39] + z[40] + z[5] + z[6] + z[63] + z[9];
	z[5] = z[179] + z[202] + z[209] + z[230] + z[235] + z[248] + z[259] + z[272] + z[295] + z[31];
	z[6] = z[181] + z[19] + z[203] + z[211] + z[231] + z[238] + z[250] + z[261] + z[274] + z[301];
	z[9] = z[180] + z[204] + z[210] + z[232] + z[236] + z[249] + z[260] + z[273] + z[296] + z[300];
	z[10] = z[180] + z[193] + z[218] + z[221] + z[236] + z[257] + z[268] + z[273] + z[286] + z[308];
	z[14] = z[184] + z[196] + z[213] + z[224] + z[237] + z[252] + z[262] + z[277] + z[289] + z[303];
	z[19] = z[184] + z[195] + z[212] + z[225] + z[237] + z[251] + z[263] + z[277] + z[288] + z[302];
	z[18] = z[18] + z[31] + z[319] + z[323] + z[338] + z[354] + z[371] + z[387] + z[48];
	z[31] = z[301] + z[320] + z[326] + z[34] + z[345] + z[359] + z[376] + z[389] + z[49];
	z[34] = z[304] + z[322] + z[329] + z[348] + z[362] + z[37] + z[379] + z[392] + z[51];
	z[25] = z[25] + z[29] + z[304] + z[315] + z[344] + z[367] + z[382] + z[392] + z[45];
	z[20] = z[20] + z[21] + z[307] + z[318] + z[332] + z[336] + z[353] + z[370] + z[43];
	z[21] = z[22] + z[27] + z[309] + z[321] + z[335] + z[341] + z[358] + z[375] + z[46];
	z[22] = z[24] + z[314] + z[325] + z[343] + z[366] + z[381] + z[390] + z[398] + z[47];
	z[24] = z[26] + z[33] + z[368] + z[383] + z[403] + z[405] + z[410] + z[44] + z[50];
	z[26] = z[28] + z[350] + z[369] + z[384] + z[404] + z[406] + z[407] + z[411] + z[52];
	z[27] = z[30] + z[385] + z[393] + z[399] + z[401] + z[408] + z[412] + z[44] + z[53];
	z[28] = z[32] + z[364] + z[386] + z[394] + z[400] + z[402] + z[409] + z[413] + z[54];
	z[1] = z[1] + z[15] + z[17] + z[2] + z[3] + z[35] + z[38] + z[4] + z[41];
	z[2] = z[310] + z[333] + z[337] + z[356] + z[372] + z[387] + z[42] + z[5] + z[7];
	z[3] = z[23] + z[313] + z[342] + z[365] + z[380] + z[389] + z[396] + z[6] + z[8];
	z[4] = z[11] + z[311] + z[334] + z[340] + z[355] + z[374] + z[388] + z[414] + z[9];
	z[5] = z[10] + z[12] + z[311] + z[324] + z[339] + z[357] + z[373] + z[395] + z[414];
	z[6] = z[13] + z[14] + z[312] + z[327] + z[346] + z[361] + z[377] + z[390] + z[397];
	z[7] = z[16] + z[19] + z[312] + z[328] + z[347] + z[360] + z[378] + z[391] + z[397];
	
	/* Output stiffness */
	Kempf[0] = z[20];
	Kempf[1] = z[4];
	Kempf[2] = z[27];
	Kempf[3] = z[7];
	Kempf[4] = z[31];
	Kempf[5] = z[18];
	
	Kempf[6] = z[2];
	Kempf[7] = z[21];
	Kempf[8] = z[28];
	Kempf[9] = z[34];
	Kempf[10] = z[6];
	Kempf[11] = z[5];
	
	Kempf[12] = z[3];
	Kempf[13] = z[25];
	Kempf[14] = z[1];
	Kempf[15] = z[26];
	Kempf[16] = z[24];
	Kempf[17] = z[22];	
}
